<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"decodificar.org","root":"/","scheme":"Mist","version":"8.0.0-rc.4","exturl":false,"sidebar":{"position":"left","display":"remove","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeIn","post_body":"none","coll_header":"fadeIn","sidebar":"fadeInUp"}},"path":"search.xml"};
  </script>

  <meta name="description" content="La evolución de la pandemia puede verse distinta si miramos los números nacionales o los provinciales. Entender cómo evoluciona en cada región nos permite tomar decisiones más focalizadas y específica">
<meta property="og:type" content="article">
<meta property="og:title" content="¿Cómo evoluciona mi provincia?">
<meta property="og:url" content="http://decodificar.org/covid/evolucion_por_provincia/index.html">
<meta property="og:site_name" content="Decodificar: COVID19">
<meta property="og:description" content="La evolución de la pandemia puede verse distinta si miramos los números nacionales o los provinciales. Entender cómo evoluciona en cada región nos permite tomar decisiones más focalizadas y específica">
<meta property="og:locale" content="es_ES">
<meta property="article:published_time" content="2020-07-07T04:59:42.639Z">
<meta property="article:modified_time" content="2020-07-07T04:59:42.639Z">
<meta property="article:author" content="Fundacion Bunge y Born">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://decodificar.org/covid/evolucion_por_provincia/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'es'
  };
</script>

  <title>¿Cómo evoluciona mi provincia? | Decodificar: COVID19</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-132699662-2"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-132699662-2');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

      <script src="https://d3js.org/d3.v5.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.js"></script>
      <script src="https://unpkg.com/enter-view"></script>
      <link rel="stylesheet" href="/styles/scrolly.css">
  
</head>

<body itemscope itemtype="http://schema.org/WebPage">
      <script>
      var es_ES = {
        "decimal": ",",
        "thousands": ".",
        "grouping": [3],
        "currency": ["$", ""],
        "dateTime": "%a %b %e %X %Y",
        "date": "%d/%m/%Y",
        "time": "%H:%M:%S",
        "periods": ["AM", "PM"],
        "days": ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"],
        "shortDays": ["Dom", "Lun", "Mar", "Mi", "Jue", "Vie", "Sab"],
        "months": ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        "shortMonths": ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
    };

    d3.timeFormatDefaultLocale(es_ES);
    d3.formatDefaultLocale(es_ES);

    var isMobile = document.getElementsByTagName("body")[0].clientWidth < 768 ? 1 : 0; 
    

    var provinciasAbreviadas= {
        "Buenos Aires" : "BsAs",
        "CABA":"CABA",
        "Chaco":"Chaco",
        "Chubut":"Chu.",
        "Córdoba":"Cba.",
        "Corrientes":"Corr.",
        "Entre Ríos":"E.Ríos",
        "Formosa":"Form.",
        "Jujuy":"Juj.",
        "La Pampa":"Pampa",
        "La Rioja":"Rioja",
        "Mendoza":"Mdza",
        "Misiones":"Mis.",
        "Neuquén":"Nqn",
        "Río Negro":"R.Negro",
        "Salta":"Salta",
        "San Juan":"S.Juan",
        "San Luis":"S.Luis",
        "Santa Cruz":"S.Cruz",
        "Santa Fe":"S.Fe",
        "Santiago del Estero":"SdE",
        "Tierra del Fuego":"TdF",
        "Tucumán":"Tuc"
        }



var colores = d3.scaleOrdinal()
        .domain([0,5])
        .range(["#00468B","#8B6BAF","#F04E53","#F26522","#62BB46"]);


var coloreaCategorias = d3.scaleOrdinal()
        .range(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#af7aa1","#ff9da7","#9c755f","#8a7e78"]);

      </script>

  

  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Cambiar a barra de navegación">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Decodificar: COVID19</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Entendiendo la pandemia</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-inicio">

    <a href="/" rel="section">Inicio</a>

  </li>
        <li class="menu-item menu-item-acerca-del-proyecto">

    <a href="/about/" rel="section">Acerca del proyecto</a>

  </li>
  </ul>
</nav>




</div>
      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="es">
    <link itemprop="mainEntityOfPage" href="http://decodificar.org/covid/evolucion_por_provincia/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fundacion Bunge y Born">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Decodificar: COVID19">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ¿Cómo evoluciona mi provincia?
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar-check"></i>
              </span>
              <!-- <span class="post-meta-item-text">Editado el</span> -->
              <time title="Modificado por: 7 de julio de 2020 01" itemprop="dateModified" datetime="2020-07-07T01:59:42-03:00">Actualizado 7 de julio de 2020</time>
            </span>

          
            <div class="post-description">La evolución de la pandemia puede verse distinta si miramos los números nacionales o los provinciales. Entender cómo evoluciona en cada región nos permite tomar decisiones más focalizadas y específicas para cada una. ¿Qué nos dicen los números de cada provincia?</div>

         

          
        </div>
      </header>



    
    
    
    <div class="post-body" itemprop="articleBody">
<!-- imagen destacada -->
        
      
        


<style>


    .axis path, .axis line {
      fill: none;
      stroke: #D4D8DA;
      stroke-width: 1px;
     
    }

    .axis--y .domain, .axis--x .domain{
        display: none;
    }
    
    
    .axis--y .tick{
        stroke-width: 1px;
        stroke-dasharray: 3px 2px;
    }

    .axis--x .tick line{
        stroke-width: 2px;
    }
    
    .axis--y .tick text{
        text-anchor: start;
	}
	
	text.nombreProvincias{
		font-size: 11px;
	}


    .axis-title {
      fill: #222;
        font-size: 16px;
        text-anchor: start;
    }
    
    .line {
      fill: none;
      stroke: #a3a3a3;
      stroke-width: 1px;
    }
    .linePais {
      fill: none;
      stroke: #00468B;
      stroke-width: 2px;
	}
	
	
    .tendencia{
        fill: none;
        stroke-width: 3px;
        stroke-linecap: round;
    }

    .duplicacionesTextos{
        text-anchor: end;
        font-size: 14px;
        font-weight: 600;
	}
	
	span.pcias{
		display: block;
		margin-top: 11px;
	}
  
	#contenedorGrafico.sticky{
			margin-bottom: 191px;
		}
     
    @media only screen and (min-width: 768px) {
      
    }
    
</style>


<section id='scrolly'>
    <div class='scrolly'>
<!--         <div class='stepFijo'>
        </div>
 -->
        <!-- aca va el grafico que va a quedar fijo -->
        <figure id="contenedorGrafico" class='sticky' >
        </figure>

        <!-- acá van los textos de cada paso -->
        <article>
            <div class='step' data-index='0'>
				<p> Las medidas para evitar el movimiento de personas entre distritos o provincias nos permiten "desarmar" el problema grande en partes más chicas, con la esperanza de que así sea más fácil enfrentarlo.
				</p>
	
				<p>
                    Veamos, ¿cómo va cada provincia? La respuesta está en este gráfico, pero hay que mirarlo por partes.
                </p>
            </div>
            
            <div class='step' data-index='1'>
                <p>
                    Esta es la curva de todos los casos confirmados de COVID-19 en Argentina.
				</p>
				<p>
					Si ya viste <a href="/covid/el_ritmo_de_la_pandemia/">esta otra historia</a>, sabés que para saber cómo está avanzando la pandemia lo importante es el ritmo. En el gráfico, el ritmo se ve en la inclinación de la curva:
				</p>
				<p>
					mayor	<-->	mayor
					inclinación		ritmo
							(tiempo de
							duplicación
							más corto)
						</p>
						<p>
					Ahora bien, la curva de la Argentina tiene un ritmo como país. Pero eso no quiere decir que todas las provincias estén igual.
                </p>
            </div>
            <div class='step' data-index='2'>
                <p>
                    Dentro de la curva de Argentina están los datos de cada provincia, y podemos comparar la inclinación de cada una por separado.
				</p>
				<p>

¡No es igual para todas!

                </p>
            </div>
            <div class='step' data-index='3'>
                <p>
                    Para saber cómo va el ritmo de cada provincia, tenemos que mirar la inclinación de las partes <a href="/covid/el_ritmo_de_la_pandemia/"> rectas de cada curva</a>, por ejemplo en los últimos días.
                </p><p>
					Esa inclinación nos da el tiempo de duplicación de casos, que no es el mismo en todos los lugares.
                </p>
            </div>
            <div class='step' data-index='4'>
                <p>
					El comienzo de la pandemia en Argentina estuvo marcado por curvas muy empinadas en todos los distritos que tenían casos.
            </p><p>
                El ritmo era muy alto, es decir, el número de casos se duplicaba en pocos días (tiempo de duplicación muy corto) y todo el país estaba en fase 1 (aislamiento estricto).
                </p>
            </div>
            <div class='step' data-index='5'>
                <p>
                    Considerando los datos de las últimas dos semanas, estas son las provincias en las que el número de casos confirmados se duplica en menos de 5 días.
                </p><p>
                    Es decir, el ritmo de la pandemia en estas provincias es muy alto
					<span class="pcias"></span>
				</p>
            </div>
            <div class='step' data-index='6'>
                <p>
					Estas son las provincias en las que sus casos confirmados se están duplicando con tiempos de entre 5 y 15 días.
					<span class="pcias"></span>
				</p>
            </div>

			<div class='step' data-index='7'>
                <p>
					En éstas, la duplicación de casos se da entre 15 y 25 días.
					<span class="pcias"></span>
				</p>
			</div>
			
			<div class='step' data-index='8'>
                <p>
					Y en estas provincias, donde los brotes parecen estar más controlados, y los casos se están duplicando muy lentamente (cada 25 días o más)...
					<span class="pcias"></span>
				</p>
			</div>

			<div class='step' data-index='9'>
                <p>
					...o también están aquellas que, directamente, no tienen casos nuevos
					<span class="pcias"></span>
				</p>
			</div>

			<div class='step' data-index='10'>
                <p>
					Separar el todo en sus partes es muy importante para tomar decisiones, especialmente cuando el comportamiento de las partes difiere entre sí.
                </p>
				<p>
					En algunos lugares fue y es posible flexibilizar las medidas de aislamiento social antes que en otros. Pero, más importante aún,  ¡la evolución local de la pandemia puede ir cambiando! Y, por lo tanto, las medidas también.
                </p>
			</div>
			
			<div class='step' data-index='11'>
				<p> 
					Y con las ciudades, ¿será igual? Exactamente; de la misma forma que separamos en partes por provincias, también podríamos hacerlo con ciudades.
				</p>
					<p> Por ahora, no te olvides de seguir el ritmo de la pandemia en tu provincia.
	
				</p>
			</div>
			
			
        </article>

<!--         <div class='stepFijo' >
      
        </div>
 -->
    </div>

</section>


 <!-- Scripts -->
 <script>
	
	//********************* CARGA DATOS ************

Promise.all([
    d3.csv("/datos/tablaMaestra.csv"),
	d3.csv("/datos/Fuente_datos_historias - E1_ritmo.csv"),
	d3.csv("/datos/Fuente_datos_historias - E4_ritmo_prov.csv")
]).then(function(files) {
	



    // **** CODIGO DEL SCROLLY *******


    const container = d3.select('#scrolly'); //busco el container total
    const stepSel = container.selectAll('.step'); // selecciono los "steps"

    function updateChart(index) {  // funcion que llama cada vez que cruza un humbral
        const sel = container.select(`[data-index='${index}']`);
        stepSel.classed('is-active', (d, i) => i === index);
        
        scrollyTelling(index); // <<<<< AQUI LLAMA AL GRAFICO VERDADERO
    }

    function init() { // configuracion inicial
        Stickyfill.add(d3.select('.sticky').node()); // fallback para browsers sin sticky

        enterView({
            selector: stepSel.nodes(),
            offset: 0.5,
            enter: el => {
                const index = +d3.select(el).attr('data-index');
                updateChart(index);
            },
            exit: el => {
                let index = +d3.select(el).attr('data-index');
                index = Math.max(0, index - 1);
                updateChart(index);
            }
        });
    }
    init()

    // **** END SCROLLY *******


/* COLORES
azul #00468B
violeta #8B6BAF
rojo #F04E53
naranja #F26522
verde #62BB46
*/
       
        
var ejeY, ejeX, tituloY, minDate, maxDate, line, linePais;

var altoMaximo = 1.3; // cuantas veces el ancho permitimos que sea el alto maximo

var svg = d3.select("#contenedorGrafico").append("svg"),
    margin = isMobile ? {top: 35, right: 20, bottom: 25, left: 20} : {top: 50, right: 30, bottom: 50, left: 30},
    width =  +d3.select('#contenedorGrafico').style('width').slice(0, -2),
    height = +d3.select('#contenedorGrafico').style('height').slice(0, -2);

    if (height > altoMaximo*width) {
        svg.style('margin-top', (height - altoMaximo*width)/2 + "px")
        height = altoMaximo*width;
    }

    svg.attr("viewBox", [0, 0, width, height]);

    height = height - margin.top - margin.bottom;
    width = width - margin.left - margin.right;
    

var parseTime = d3.timeParse("%Y-%m-%d");

var x = d3.scaleTime().range([0, width]);
var yLog = d3.scaleLog().range([height, 0]);

var yLogAxis = d3.axisLeft(yLog);
    yLogAxis.ticks(4).tickFormat(d3.format(",.1r")).tickSizeInner(-6);



var grafico = svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
	;
	
var clip = grafico.append("defs").append("svg:clipPath")
        .attr("id", "clip")
        .append("svg:rect")
        .attr("width", width )
        .attr("height", height )
        .attr("x", 0)
        .attr("y", 0);


	line = d3.line()
	.defined(d => d>0)
    .x((d,i) => x(dataParaGrafico.dates[i]))
	.y(d => yLog(d))
	;

	linePais = d3.line()
    .x(d => x(d.fecha))
	.y(d => yLog(d.casos_tot))
	;


    var data = files[0] // datos principales;

	var duplicaciones = files[1] // funciones de duplicacion de casos;
	
	var dataProv = files[2] // funciones de duplicacion de casos;

    data.forEach(function(d) {
      d.fecha = parseTime(d.fecha);
      d.casos_tot = +d.casos_tot;
	});
	
    duplicaciones.forEach(function(d,i) {
      d.desdeX = parseTime(d.desdeX);
      d.hastaX = parseTime(d.hastaX);
      d.desdeY = +d.desdeY;
      d.hastaY = +d.hastaY;
      d.index = i;
	});
	
	dataProv.forEach(function(d) {
    	d.fecha = d3.timeDay.offset(parseTime("2020-03-03"), d.dia) //transforma de numero de dia a fecha
		d.casos_tot = +d.casos_tot;
		d.dup = isNaN(d.dup)? 1000 : +d.dup;
		d.prov= d.prov.replace("Santiago", "Sgo.")
		d.prov= d.prov.replace("Tierra", "T.")
	});
	

	dataProv = d3.nest().key(d => d.prov).entries(dataProv)

		minDate = parseTime("2020-03-01"); //fecha de inicio el primero de marzo para que aparezca marzo!
		maxDate = d3.max(data, d => d.fecha);
	
	var dataParaGrafico = {
		series: dataProv.map(obj => {return {"name":obj.key,"dup":obj.values[0].dup, "values":obj.values.map(r=>r.casos_tot)}})
						.sort((a, b) => d3.descending(a.values[a.values.length-1], b.values[b.values.length-1])),
    	dates: d3.timeDay.range(minDate, d3.timeDay.offset(maxDate))
	}


	x.domain([minDate,maxDate]);
	var yDomainPais = [d3.min(data, function(d) { return d.casos_tot; }), d3.max(data, function(d) { return d.casos_tot; })+20000];
	var yDomainProv = [d3.min(dataProv, function(d) { return d.casos_tot; }), d3.max(data, function(d) { return d.casos_tot; })+20000];
	yLog.domain(yDomainPais);


	

     ejeX = grafico.append("g") // EJE X
        .attr("class", "axis axis--x")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x)
        	.ticks(d3.timeMonth.every(1)))
        .call(ajustaMesesEjeX)
        ;

    ejeY = grafico.append("g") // EJE Y
        .attr("class", "axis axis--y")
	   	.call(yLogAxis)
	        ;
    
    tituloY = ejeY.append("text")
        .attr("class", "axis-title")
        .attr("y", -8)
        
        .text("Casos (logarítmico)");


    grafico.append("path") // Linea DE DATOS PAIS
		.attr("stroke", "black")
	 	.style("opacity",0)
	    .datum(data)
        .attr("class","linePais")
    	.attr("d", linePais);

	  var provincias = grafico.append("g").attr("id","provincias")
						  .attr("clip-path", "url(#clip)");


	  provincias.selectAll("path") // AGREGA LAS LINEAS DE LAS PROVINCIAS
				.data(dataParaGrafico.series )
				.join("path")
				.attr("class", "prov line")
				.style("stroke", d=>coloreaCategorias(d.name))
				.attr("d", d => line(d.values));

	provincias.append("rect").attr("width",0).attr("height",height).style("opacity",0.8).attr("id","dimmer").attr("x",width).style("fill","#f1f1f1");

	var dataParaLabels = dataParaGrafico.series.map(r=>{  //Prepara la data para poner los labels
					return  {"labelY": yLog(d3.max(r.values)),
							"name": r.name,
							"dup": r.dup,
							"values": r.values}
						});
	
	relax(dataParaLabels, 8); // Separa los labels para que no se pisen

	  provincias.selectAll("text")  // AGREGA LOS LABELS
				.data(dataParaLabels)
				.join("text")
					.attr("x",d=>x(dataParaGrafico.dates[d.values.length]))
					.attr("y",d=>d.labelY)
					.attr("dy", "3px")
					.style("fill", d=>coloreaCategorias(d.name))
					.attr("class", "prov nombreProvincias")
					.text(d=>isMobile?provinciasAbreviadas[d.name]:d.name); // provinciasAbreviadas en caso de mobile (es una variable en el layout.njk)

		

	var tendencias = grafico.append("g") // DUPLICACIONES
					.attr("id", "duplicaciones")
					;

    tendencias.selectAll("path")
     .data(duplicaciones)
     .join("path")
        .attr("class", "tendencia")
        .style("opacity", 0)
        .attr('d', d => d3.line()([[x(d.desdeX), yLog(d.desdeY)],[x(d.hastaX), yLog(d.hastaY)]]))
        .style("stroke", d => colores(d.index+1));

    tendencias.selectAll("text")
     .data(duplicaciones)
     .join("text")
        .attr("class", d=>{return "duplicacionesTextos"+" duplica"+d.index})
        .style("opacity", 0)
        .attr('x', d => Math.abs(x(d.hastaX) - x(d.desdeX))/2+ x(d.desdeX))
        .attr('y', d => yLog(d.desdeY) - 10 - Math.abs(yLog(d.hastaY) - yLog(d.desdeY) )/2)
        .style("fill", d => colores(d.index+1))
        .text(d=> { return d.duplicacion + " días"});


		d3.selectAll(".pcias").each( function(d){
			var nombres = [];
			switch (+d3.select(this.parentNode.parentNode).attr("data-index")) {
				case 5:
					nombres = dataParaLabels.filter(d=> d.dup < 5).map(r=>r.name);
					break;

				case 6:
					nombres = dataParaLabels.filter(d=> d.dup > 5 && d.dup < 15).map(r=>r.name);
					break;

				case 7:
					nombres = dataParaLabels.filter(d=> d.dup > 15 && d.dup < 25).map(r=>r.name);
					break;

				case 8:
					nombres = dataParaLabels.filter(d=> d.dup > 25 && d.dup < 100).map(r=>r.name);
					break;

				case 9:
					nombres = dataParaLabels.filter(d=> d.dup > 100).map(r=>r.name);
					break;
			
			}
				d3.select(this).html(nombres.length?"(" + nombres.join(', ')+ ")":"(Ninguna)")
				
				});
                
   


function scrollyTelling(step){

	var opacidadProvinciaApagada = 0;

    var cambia = {};
    switch (step) {
		case 2: // muestra por provincia
		/* x.domain([minDate, maxDate]);  // POR SI HAY ZOOM
			ejeX.transition().duration(400).call(d3.axisBottom(x).ticks(d3.timeMonth.every(1)))
				  .call(ajustaMesesEjeX); */
				  
		case 0: // muestra por provincia
            d3.selectAll(".linePais").transition().duration(600).style("opacity",0);
			d3.selectAll(".prov").transition().delay((d,i)=>i*10).duration(400)
					.style("opacity",1)
			//		.attr("d", d => line(d.values)) // POR SI HAY ZOOM
					;
            d3.selectAll(".tendencia").transition().duration(300).style("opacity",0);
			d3.selectAll(".duplicacionesTextos").transition().duration(300).style("opacity",0);
			break;

		case 1: // muestra pais
			d3.selectAll(".linePais").transition().duration(600).style("opacity",1);
            d3.selectAll(".prov").transition().delay((d,i)=>i*10).duration(400).style("opacity",0);
			d3.selectAll(".tendencia").transition().delay((d,i)=>400+i*200).duration(300).style("opacity",1);
			d3.selectAll(".duplicacionesTextos").transition().delay((d,i)=>400+i*200).duration(300).style("opacity",1);
        	break;

		case 3: // zoom a los ultimos 20 dias.
		d3.select("#dimmer").transition().duration(600).attr("width",0).attr("x",width);

		/* 	x.domain([d3.timeDay.offset(maxDate,-20), maxDate]) // POR SI HAY ZOOM
	    	ejeX.transition().duration(400).call(d3.axisBottom(x).ticks(d3.timeDay.every(1)))
				.call(ajustaMesesEjeX);
 			d3.selectAll(".prov").transition().delay((d,i)=>i*10).duration(400)
						.attr("d", d => line(d.values));;
		*/
        	break;

		case 4: // muestra solo primera parte
			d3.select("#dimmer").transition().duration(600).attr("width",width*0.7).attr("x",width*0.3);
			d3.selectAll(".prov").transition().duration(600).style("opacity",1);
		/* 	x.domain([minDate, maxDate]); // POR SI HAY ZOOM
			ejeX.transition().duration(400).call(d3.axisBottom(x).ticks(d3.timeMonth.every(1)))
			  	.call(ajustaMesesEjeX); 
			d3.selectAll(".prov").transition().delay((d,i)=>i*10).duration(400)
						.attr("d", d => line(d.values));;
						*/
			break;
			
		case 5: // duplica en menos de 5 días
			d3.select("#dimmer").transition().duration(600).attr("width",0).attr("x",width);
			d3.selectAll(".prov").transition().duration(600).style("opacity",d=>d.dup<5?1:opacidadProvinciaApagada);
			break;

		case 6: // duplica en 5 a 15 días
			d3.selectAll(".prov").transition().duration(600).style("opacity",d=>{
				if(d.dup<15 && d.dup>5) return 1;
				return opacidadProvinciaApagada;
			} );
			break;

		case 7: // duplica en 15 a 25 días
			d3.selectAll(".prov").transition().duration(600).style("opacity",d=>{
				if(d.dup<25 && d.dup>15) return 1;
				return opacidadProvinciaApagada;
			} );
			break;


		case 8: // duplica en mas de 25
			d3.selectAll(".prov").transition().duration(600).style("opacity",d=>{
				if(d.dup<100 && d.dup>25) return 1;
				return opacidadProvinciaApagada;
			} );
			break;

		case 9: // sin casos nuevos
			d3.selectAll(".prov").transition().duration(600).style("opacity",d=>{
				if(d.dup>100) return 1;
				return opacidadProvinciaApagada;
			} );
			break;

		case 10: // sin casos nuevos
			d3.selectAll(".prov").transition().duration(600).style("opacity",1);
			break;
    }

          

}



//********** funciones

 
function ajustaMesesEjeX(g) {
		  // ESTO PONE LOS NOMBRES DE LOS MESES EN MEDIO DE CADA MES
            g.selectAll(".tick:not(:last-of-type) text") // para todos los meses menos el ultimo
                .attr("dx", x(parseTime("2020-03-16"))) // mueve el equivalente a 15 dias
                .attr("dy", "0.3em") ;
            
            g.selectAll(".tick:last-of-type text") // el ultimo si no esta completo lo centra en los dias que haya
                .attr("dx",  x(parseTime("2020-03-" + Math.ceil((d3.timeFormat("%-d")(d3.max(data, function(d) { return d.fecha; })))/2))))
                .attr("dy", "0.3em") ;
            
            g.selectAll(".tick line") // las lineas que separan los meses, mas altas
                .attr("y2", "1.4em") ;
			}


// separa en el eje Y los datos que le lleguen con formato: 
// d.name // d.labelY // d.values
function relax(data, spacing) {
				spacing = spacing? spacing : 8;
				var dy = 1;
				var repeat = false;
				var count = 0;
				data.forEach(function(dA, i) {
					var yA = dA.labelY;
					data.forEach(function(dB, j) {
						var yB = dB.labelY;
						if (i === j) {
							return;
						}
						diff = yA - yB;
						if (Math.abs(diff) > spacing) {
							return;
						}
						repeat = true;
						magnitude = diff > 0 ? 1 : -1;
						adjust = magnitude * dy;
						dA.labelY = +yA + adjust;
						dB.labelY = +yB - adjust;
						dB.labelY = dB.labelY > height ? height : dB.labelY
						dA.labelY = dA.labelY > height ? height : dA.labelY
					})
				})
				if (repeat) {
					relax(data, spacing);
				}
			}

		});

</script>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/covid/la_cantidad_de_contagiados/" rel="prev" title="¿Cuántos contagiados hay realmente?">
      <i class="fa fa-chevron-left"></i> ¿Cuántos contagiados hay realmente?
    </a></div>
      <div class="post-nav-item">
    <a href="/covid/achatar_la_curva/" rel="next" title="Hay que achatar la curva… ¿qué curva?">
      Hay que achatar la curva… ¿qué curva? <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        



<div class="copyright">
Un proyecto de la <a href="https://www.fundacionbyb.org/" target="_blank">Fundación Bunge y Born</a>, en alianza con  <a href="http://expedicionciencia.org.ar/" target="_blank">Expedición Ciencia</a>
<br/>
<small><a href="https://www.fundacionbyb.org/politica-de-privacidad" target="_blank">Política de privacidad</a></small>
</div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  
  <span class="author" itemprop="copyrightHolder">Fundacion Bunge y Born</span>
</div>
  <div class="powered-by">Creado mediante <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  

</body>
</html>
